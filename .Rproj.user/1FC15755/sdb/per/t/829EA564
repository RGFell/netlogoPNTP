{
    "contents" : "---\noutput: pdf_document\n---\n#\"Modelación de flujo de turistas en Parque Nacional Torres del Paine\"\n##Autores Derek Corcoran y Rodrigo Gomez\n####Last update: `r Sys.Date() `\n\n```{r echo=FALSE, results='hide'}\nEco_Cuernos <- read.csv(\"~/Rpntp/Eco_Cuernos.csv\", sep=\";\")\n```\n\n```{r echo=FALSE, results='hide', message=FALSE} \nlibrary(\"dplyr\", lib.loc=\"~/R/win-library/3.1\")\nlibrary(\"lubridate\", lib.loc=\"~/R/win-library/3.2\")\nlibrary(\"ggplot2\", lib.loc=\"~/R/win-library/3.2\")\nlibrary(\"knitr\", lib.loc=\"~/R/win-library/3.2\")\nlibrary(texreg)\nlibrary(xtable)\n```\n\n##Estudio de distribución del flujo de turistas\n\n**Distribución horaria de las visitas**\n\nInicialmente se realizará un estudio de la distribución de turistas para el parque Torres del Paine. En forma de ejemplo se utilizarán los datos disponibles actualmente para el contador de los Cuernos.\n\nUsaremos las horas y fechas tanto como factores como tiempos por lo que agregaremos algunas variables\n\n```{r, echo=FALSE}\ndate.as.date<-dmy(Eco_Cuernos$X)\ndate.time1<-paste(Eco_Cuernos$X,Eco_Cuernos$X.1, sep=\"-\")\ndate.time <-dmy_hm(date.time1)\ncolnames(Eco_Cuernos)[1] <- \"date.as.factor\"\nEco_Cuernos<-cbind(Eco_Cuernos, date.time ,date.as.date)\nEco_Cuernos$dia.semana <- weekdays(Eco_Cuernos$date.as.date)\nEco_Cuernos$Hora <- hour(date.time)\nstr(Eco_Cuernos)\n```\n\nPrimero que nada observemos lo que ocurre al graficar la cantidad de turistas totales agrupados por horas en que se mueven.\n\n```{r echo=FALSE}\nplot(Eco.Cuernos~X.1, main=\"Contador Cuernos\",xlab=\"Tiempo\", ylab=\"Número de turistas\",data=Eco_Cuernos)\n```\n\n####opcion grafica 2\n\n```{r}\np <- ggplot(Eco_Cuernos,aes(Hora, Eco.Cuernos))\np + geom_point(aes(color = factor(dia.semana)))+ stat_smooth(geom = \"errorbar\")\np + geom_point(aes(color = factor(dia.semana)))+ stat_smooth()\nts <- ggplot(Eco_Cuernos,aes(date.time, Eco.Cuernos))\nts + geom_point(aes(color = factor(dia.semana)))+  geom_line()\n\n```\n\nObservamos un peak en actividad a las 11 y 12 del día e inicios de actividad cercano a las 9 am finalizando al rededor de las 21 horas\n\nEsto es para el total de turistas, si solo consideramos la entrada o salida de turistas vemos que esto cambia.\n\n```{r echo=FALSE}\npar(mfrow=c(1,2))\nplot(Eco.Cuernos_IN~X.1, main=\"Entrada\",xlab=\"Tiempo\", ylab=\"Número de turistas\",data=Eco_Cuernos)\nplot(Eco.Cuernos_OUT~X.1, main=\"Salida\",xlab=\"Tiempo\", ylab=\"Número de turistas\",data=Eco_Cuernos)\n```\n  \n\nEl estudiar estos flujos permitiría el estudiar los horarios con mayor número de encuentros en sentido contrario, lo cual no necesariamente debe coincidir con el numero total de turistas.\n\n#Analisis estadistico de factores (Dia de semana y hora)\n\npara estudiar esta relacion se realizara un analisis de dos vias, primero veamos un resumen de el numero de turistas por hora para cada dia\n\n```{r, echo=FALSE}\npor.semana<-tapply(Eco_Cuernos$Eco.Cuernos,Eco_Cuernos$dia.semana,mean)\npor.semana<-t(as.matrix(por.semana))\npor.semana<-por.semana[,c(3,4,5,2,7,6,1)]\npor.semana<-t(as.matrix(por.semana))\nkable(por.semana, digits=2)\n```\n\ny el numero de turistas por hora\n\n```{r,echo=FALSE}\nkable(t(as.matrix(tapply(Eco_Cuernos$Eco.Cuernos,Eco_Cuernos$X.1,mean))),digits=2)\n\n```\n\nAhora realizamos un ANOVA de dos vias\n```{r, results='asis', echo=FALSE}\nattach(Eco_Cuernos)\nANOVA.Cuernos <- aov(Eco.Cuernos ~ X.1*dia.semana)\nfm1.table <- xtable(ANOVA.Cuernos)\nprint(fm1.table,floating=FALSE)\ninteraction.plot(X.1, dia.semana, Eco.Cuernos, type=\"b\")\n```\n\n**Comparación post-HOC via test de Tukey**\n\n```{r}\nTukeyHSD(ANOVA.Cuernos, which=\"dia.semana\", ordered=TRUE)\nplot(TukeyHSD(ANOVA.Cuernos, which=\"dia.semana\"))\n\n```\n\n\n\n*simulación*\n\nPara cada hora, se realizará un estudio de distribución del numero de turistas que llegarían. Por ejemplo, para el mes de Febrero, a la hora peak (12:00), encontramos la siguiente histograma correspondiente a la distrubucion de turistas.\n\n```{r echo=FALSE}\neco.cuernos.12 <- filter(Eco_Cuernos, X.1==\"12:00\")\n```\n\n```{r echo=FALSE}\nhist(eco.cuernos.12$Eco.Cuernos, main=NULL, xlab=\"Número de turistas\")\n```\n\nLa cual corresponde a una distribución normal de acuerdo al test de Shapiro-wilk\n\n```{r}\nshapiro.test(eco.cuernos.12$Eco.Cuernos)\n```\n\nCon una media de `r mean(eco.cuernos.12$Eco.Cuernos)` y una desviación estandard de `r sd(eco.cuernos.12$Eco.Cuernos)`.\n\nDado esto, si hicieramos simulaciones aleatorias del número de turistas que pasarían por los cuernos en 20 días consecutivos tendríamos como resultado los siguientes 20 numeros.\n\n```{r}\nset.seed(100)\nb<-rnorm(20, mean=mean(eco.cuernos.12$Eco.Cuernos), sd=sd(eco.cuernos.12$Eco.Cuernos))\nprint(b, digits=2)\n```\n\n\n#Distribución diaria del uso por turistas\n\nAdemás de esto se debe estudiar como varia por fecha la cantidad de turistas diarios, para esto sumaremos la cantidad de turistas al día y se estudiará el comportamiento de cada mes, asi como los días de semana y fin de semana.\n\n\n```{r echo=FALSE}\nCuernos.por.dia<- group_by(Eco_Cuernos, date.as.factor) %>% summarise(Por.Dia = sum(Eco.Cuernos))\nCuernos.por.dia$date.as.factor= as.Date(as.character(Cuernos.por.dia$date.as.factor), \"%d/%m/%Y\")\nCuernos.por.dia1<- Cuernos.por.dia[do.call(order,Cuernos.por.dia),]\nplot(Por.Dia~date.as.factor, xlab=\"Fecha\", ylab=\"Número de turistas\",type=\"b\", data=Cuernos.por.dia1[1:26,])\n```\n\n##Modelación espacialmente explicita\n\nEstas caracterizaciones se utilizaran para una simulación espacialmente explicita utilizando modelaciónes en base de agentes, apoyandose en la información generada por el resto de los grupos del CEQUA.\n\n\n```{r}\nmean(eco.cuernos.12$Eco.Cuernos)/sd(eco.cuernos.12$Eco.Cuernos)\n```\n",
    "created" : 1442336432376.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "854372484",
    "id" : "829EA564",
    "lastKnownWriteTime" : 1442347142,
    "path" : "C:/Users/usuario/netlogoPNTP/Informe TDP.Rmd",
    "project_path" : "Informe TDP.Rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}